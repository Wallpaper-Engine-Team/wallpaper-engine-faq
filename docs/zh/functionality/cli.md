---
sidebarDepth: 2
---

# 命令行控制

您可以使用命令行参数来控制 Wallpaper Engine。 这使您可以通过快捷方式、宏绑定或您选择的任何一种自行编写的脚本或代码，来访问该应用程序的大多数功能。 例如，您可以暂停或停止所有壁纸，更改壁纸，甚至更改正在运行的壁纸的设置。

请确保 Wallpaper Engine 已在运行，然后使用本指南中列出的任何命令参数，通过运行程序的主要进程 *wallpaper32.exe*（如果使用该应用程序的 64 位版本，则为 *wallpaper64.exe*）向 Wallpaper Engine 发送命令。 您可在 `wallpaper_engine` 安装目录中找到可执行文件。

所有命令均作为 `-control` 参数的值发出。 例如，暂停命令可按照如下方式执行：

``` powershell
wallpaper32.exe -control pause
```

对于包含空格的字符串，请务必使用双引号 **"** 字符：

``` powershell
wallpaper32.exe -control openWallpaper -file "C:\Program Files (x86)\Steam\steamapps\common\wallpaper_engine\projects\myprojects\myWallpaper\project.json"
```

## 命令概览

### 暂停

暂停所有壁纸。

``` powershell
-control pause
```

### 停止

停止所有壁纸。

``` powershell
-control stop
```

### 播放

恢复所有暂停或停止的壁纸。

``` powershell
-control play
```

### 静音

使所有壁纸静音。

``` powershell
-control mute
```

### 取消静音

使所有壁纸取消静音。

``` powershell
-control unmute
```

### 打开壁纸

如果给定显示器或第一个显示器未指定任何壁纸，为其加载新壁纸。 您可以使用 `location` 或 `monitor` 参数来选择要加载壁纸的显示器，或使用 `playInWindow` 参数在窗口中打开壁纸。

``` powershell
-control openWallpaper -file <string> [-location <string>] [-monitor <number>]
        [-playInWindow <string>] [-width <number>] [-height <number>]
        [-x <number>] [-y <number>] [-preset <string>]
```

* **file：**要打开的壁纸的 project.json 的路径，或壁纸文件的直接路径 (.mp4 etc)。
* **location*（可选）*：**显示器内部标识符。 它们由您的 PC 生成，可在 config.json 文件中找到。
* **monitor*（可选）*：**要加载壁纸的显示器的索引，从 0 开始。
* **preset*（可选）*：**要加载的本地预设的名称，您必须已经事先创建并保存该本地预设。
* **playInWindow*（可选）*：**如果您想在一个窗口中打开/控制多款壁纸，则为该窗口的名称。
  * **width*（可选）*：**窗口宽度。
  * **height *(optional)*:** Height of window.
  * **x *(optional)*:** Horizontal position of window.
  * **y *(optional)*:** Vertical position of window.

### Next Wallpaper

Skips to the next wallpaper of a given monitor or all monitors if none specified.

``` powershell
-control nextWallpaper [-location <string>] [-monitor <number>]
```

### Remove Wallpaper

Removes a wallpaper from a specified monitor or window or removes all wallpapers.

``` powershell
-control closeWallpaper [-location <string>] [-monitor <number>]
```

* **location *(optional)*:** Internal identifier of the monitor or the window name you specified.
* **monitor *(optional)*:** Index of the monitor to close the wallpaper from, begins with 0.

### Open Playlist

Loads a new wallpaper for a given monitor or the first monitor if none was specified. You can use either the location or monitor parameter to choose which monitor to load the wallpaper on.

``` powershell
-control openPlaylist -playlist <string> [-location <string>] [-monitor <number>]
```

* **playlist:** Name of the playlist you have created and saved in Wallpaper Engine.
* **location *(optional)*:** Internal identifier of the monitor. You can find these in the config.json file and they are generated by your PC.
* **monitor *(optional)*:** Index of the monitor to load the playlist on, begins with 0.

### Apply Wallpaper Settings

Applies wallpaper properties on-the-fly to a given wallpaper or all wallpapers. This allows you to dynamically change any settings that belong to a wallpaper while the program is running without opening the wallpaper browser and manually changing them. You can find a list of available properties in the browser easily by clicking on **Share JSON** on the right-side when selecting any wallpaper in the browser.

``` powershell
-control applyProperties -properties <JSON> [-location <string>] [-monitor <number>]
```

* **properties:** Properties defined as **JSON** string to be applied. The string must be specially escaped with `RAW~(` and `)~END` as delimiters - see examples below!
* **location *(optional)*:** Internal identifier of the monitor or the window name you specified.
* **monitor *(optional)*:** Index of the monitor to update the properties on, begins with 0.

Example of changing a wallpaper setting named `rate` to 10:

``` cpp 
-control applyProperties -properties RAW~({"rate":10})~END
```

Example of changing a wallpaper scheme color setting to red (`"1 0 0"` represents *RGB* values):

``` cpp
-control applyProperties -properties RAW~({"schemecolor":"1 0 0"})~END
```

### Hide Desktop Icons

Hides the desktop icons.

``` powershell
-control hideIcons
```

### Show Desktop Icons

Shows the desktop icons.

``` powershell
-control showIcons
```

